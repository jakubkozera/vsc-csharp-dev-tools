"use strict";(self.webpackChunkcsharp_dev_tools_docs=self.webpackChunkcsharp_dev_tools_docs||[]).push([[6786],{5750:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/secret-scanning-2728a4d948bcd759bc9e0b3e72f4b7ac.png"},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(6540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},8516:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"tools/secret-scanning","title":"Secret Scanning","description":"Short, human version: this tool helps you find accidentally committed secrets in your code and configs \u2014 API keys, tokens, passwords, and similar items that shouldn\'t be in a repository.","source":"@site/docs/tools/secret-scanning.md","sourceDirName":"tools","slug":"/tools/secret-scanning","permalink":"/vsc-csharp-dev-tools/tools/secret-scanning","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Diagrams","permalink":"/vsc-csharp-dev-tools/tools/diagrams"},"next":{"title":"Text Tools","permalink":"/vsc-csharp-dev-tools/tools/text-tools"}}');var i=s(4848),r=s(8453);const o={sidebar_position:5},c="Secret Scanning",a={},l=[{value:"What this is about",id:"what-this-is-about",level:2},{value:"What gets scanned",id:"what-gets-scanned",level:2},{value:"How it works (short)",id:"how-it-works-short",level:2},{value:"Scanning modes",id:"scanning-modes",level:2},{value:"How to start",id:"how-to-start",level:2},{value:"What the results include",id:"what-the-results-include",level:3},{value:"Review and actions",id:"review-and-actions",level:3},{value:"What to do when you find a secret",id:"what-to-do-when-you-find-a-secret",level:2},{value:"Simple best-practices (examples)",id:"simple-best-practices-examples",level:2},{value:"Integrating into your workflow",id:"integrating-into-your-workflow",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"secret-scanning",children:"Secret Scanning"})}),"\n",(0,i.jsx)(n.p,{children:"Short, human version: this tool helps you find accidentally committed secrets in your code and configs \u2014 API keys, tokens, passwords, and similar items that shouldn't be in a repository."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Secret Scanning Interface",src:s(5750).A+"",width:"597",height:"677"})}),"\n",(0,i.jsx)(n.h2,{id:"what-this-is-about",children:"What this is about"}),"\n",(0,i.jsx)(n.p,{children:"C# Dev Tools includes secret scanning powered by TruffleHog. It looks through project files, searches for high-entropy patterns and known signatures, and points out places that may contain sensitive data. Not every match is an actual secret \u2014 you may see false positives \u2014 but it's a reliable starting point for manual review."}),"\n",(0,i.jsx)(n.h2,{id:"what-gets-scanned",children:"What gets scanned"}),"\n",(0,i.jsx)(n.p,{children:"Common places we check:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"source files (C#, JavaScript, Python, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"configuration files (appsettings.json, web.config, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"environment files (.env, .env.local)"}),"\n",(0,i.jsx)(n.li,{children:"documentation (README.md, docs folder)"}),"\n",(0,i.jsx)(n.li,{children:"scripts (PowerShell, Bash, Batch)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Types of secrets that can be detected:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"API keys (AWS, Azure, Google Cloud, GitHub tokens, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"database credentials (connection strings, passwords)"}),"\n",(0,i.jsx)(n.li,{children:"authentication tokens (JWT, OAuth secrets)"}),"\n",(0,i.jsx)(n.li,{children:"encryption keys and private certificates"}),"\n",(0,i.jsx)(n.li,{children:"third-party service tokens (Slack, Discord webhooks, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"custom patterns (you can add rules for project-specific secrets)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-it-works-short",children:"How it works (short)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"We discover files in the workspace matching supported types."}),"\n",(0,i.jsx)(n.li,{children:"Each file is analyzed using pattern matching, entropy checks, and TruffleHog rules."}),"\n",(0,i.jsx)(n.li,{children:"When suspicious items are found we try to verify them if possible."}),"\n",(0,i.jsx)(n.li,{children:"The tool generates a report with findings and metadata."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"TruffleHog is an open-source engine that uses entropy analysis and many detection rules to reduce false positives and cover a wide range of secret types. You can also enable Git history scanning to find secrets that were committed in the past."}),"\n",(0,i.jsx)(n.h2,{id:"scanning-modes",children:"Scanning modes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Filesystem Scan \u2014 a fast, lightweight scan of files in the current workspace. Good for quick checks."}),"\n",(0,i.jsx)(n.li,{children:"Git History Scan \u2014 scans commit history; more thorough but slower. Useful for audits."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-to-start",children:"How to start"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Open Solution Explorer"}),"\n",(0,i.jsx)(n.li,{children:"Go to the Tools section"}),"\n",(0,i.jsx)(n.li,{children:'Select "Secret Scanning"'}),"\n",(0,i.jsx)(n.li,{children:"Pick a scan mode (Filesystem or Git History)"}),"\n",(0,i.jsx)(n.li,{children:"Wait for the scan to finish"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"what-the-results-include",children:"What the results include"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Active secrets \u2014 verified or high-confidence items that need quick action."}),"\n",(0,i.jsx)(n.li,{children:"All findings \u2014 the total list of potential secrets (both verified and unverified)."}),"\n",(0,i.jsx)(n.li,{children:"File coverage \u2014 number of files scanned, duration and performance stats."}),"\n",(0,i.jsx)(n.li,{children:"Ignored \u2014 findings you've previously reviewed and marked as false positives."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"review-and-actions",children:"Review and actions"}),"\n",(0,i.jsx)(n.p,{children:"For each finding you can:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"View details (file location and surrounding context)"}),"\n",(0,i.jsx)(n.li,{children:"Open the file in the editor"}),"\n",(0,i.jsx)(n.li,{children:"Mark as ignored (false positive)"}),"\n",(0,i.jsx)(n.li,{children:"Copy details to your notes or ticketing system"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Typical review flow:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check the context \u2014 is this actually a secret?"}),"\n",(0,i.jsx)(n.li,{children:"If yes \u2014 rotate/regenerate the secret, remove it from code, and move it to a secret manager."}),"\n",(0,i.jsx)(n.li,{children:"If it's a false positive \u2014 mark it ignored."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"what-to-do-when-you-find-a-secret",children:"What to do when you find a secret"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Rotate compromised keys and passwords immediately."}),"\n",(0,i.jsx)(n.li,{children:"Remove the secret from the repository and replace it with a safe configuration."}),"\n",(0,i.jsx)(n.li,{children:"If needed, inspect Git history and remove or rewrite past commits that contain secrets."}),"\n",(0,i.jsx)(n.li,{children:"Store secrets in a dedicated secret manager (Azure Key Vault, AWS Secrets Manager, etc.)."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"simple-best-practices-examples",children:"Simple best-practices (examples)"}),"\n",(0,i.jsx)(n.p,{children:"Don't hardcode secrets in code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// BAD: secret in code\nvar apiKey = "sk-1234567890abcdef";\n\n// BETTER: use environment variables\nvar apiKey = Environment.GetEnvironmentVariable("API_KEY");\n'})}),"\n",(0,i.jsx)(n.p,{children:'Use "user secrets" during development:'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'dotnet user-secrets set "ConnectionStrings:DefaultConnection" "your-connection-string"\n'})}),"\n",(0,i.jsx)(n.p,{children:"In production, keep secrets in a secure store (example: Azure Key Vault):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'var client = new SecretClient(new Uri(keyVaultUrl), new DefaultAzureCredential());\nvar secret = await client.GetSecretAsync("database-connection");\n'})}),"\n",(0,i.jsx)(n.h2,{id:"integrating-into-your-workflow",children:"Integrating into your workflow"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Run scans pre-commit (pre-commit hooks)"}),"\n",(0,i.jsx)(n.li,{children:"Include secret scanning in CI/CD pipelines"}),"\n",(0,i.jsx)(n.li,{children:"Schedule regular audits"}),"\n",(0,i.jsx)(n.li,{children:"Train the team on secure handling of secrets"}),"\n",(0,i.jsx)(n.li,{children:"Use a proper secret storage solution for production"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/trufflesecurity/trufflehog",children:"TruffleHog GitHub Repository"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://trufflesecurity.com/trufflehog",children:"TruffleHog Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",children:"OWASP Secret Management Guide"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/azure/key-vault/",children:"Azure Key Vault Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/secretsmanager/",children:"AWS Secrets Manager"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Regular secret scanning is an easy way to reduce the risk of accidental data leaks \u2014 the tool raises flags, and your team decides how to act on them."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);