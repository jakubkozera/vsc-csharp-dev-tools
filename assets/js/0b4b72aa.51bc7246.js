"use strict";(self.webpackChunkcsharp_dev_tools_docs=self.webpackChunkcsharp_dev_tools_docs||[]).push([[6786],{5750:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/secret-scanning-2728a4d948bcd759bc9e0b3e72f4b7ac.png"},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}},8516:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"tools/secret-scanning","title":"Secret Scanning","description":"Comprehensive security tool for detecting exposed secrets, credentials, and sensitive information in your codebase.","source":"@site/docs/tools/secret-scanning.md","sourceDirName":"tools","slug":"/tools/secret-scanning","permalink":"/vsc-csharp-dev-tools/tools/secret-scanning","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Diagrams","permalink":"/vsc-csharp-dev-tools/tools/diagrams"},"next":{"title":"Text Tools","permalink":"/vsc-csharp-dev-tools/tools/text-tools"}}');var r=s(4848),t=s(8453);const c={sidebar_position:5},l="Secret Scanning",o={},a=[{value:"Overview",id:"overview",level:2},{value:"What Gets Scanned",id:"what-gets-scanned",level:2},{value:"File Types",id:"file-types",level:3},{value:"Secret Types Detected",id:"secret-types-detected",level:3},{value:"How Secret Scanning Works",id:"how-secret-scanning-works",level:2},{value:"Detection Process",id:"detection-process",level:3},{value:"TruffleHog Integration",id:"trufflehog-integration",level:3},{value:"Scanning Modes",id:"scanning-modes",level:3},{value:"Using Secret Scanning",id:"using-secret-scanning",level:2},{value:"Starting a Scan",id:"starting-a-scan",level:3},{value:"Scan Results",id:"scan-results",level:3},{value:"Managing Findings",id:"managing-findings",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"Immediate Actions",id:"immediate-actions",level:3},{value:"Prevention Strategies",id:"prevention-strategies",level:3},{value:"Secure Development Workflow",id:"secure-development-workflow",level:3},{value:"Resources",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"secret-scanning",children:"Secret Scanning"})}),"\n",(0,r.jsx)(n.p,{children:"Comprehensive security tool for detecting exposed secrets, credentials, and sensitive information in your codebase."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Secret Scanning Interface",src:s(5750).A+"",width:"597",height:"677"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["C# Dev Tools includes a powerful secret scanning feature that helps protect your applications by detecting potentially exposed secrets, API keys, passwords, and other sensitive information in your codebase. The tool uses ",(0,r.jsx)(n.a,{href:"https://github.com/trufflesecurity/trufflehog",children:"TruffleHog"}),", an industry-standard secret detection engine, to perform comprehensive scans."]}),"\n",(0,r.jsx)(n.h2,{id:"what-gets-scanned",children:"What Gets Scanned"}),"\n",(0,r.jsx)(n.p,{children:"The secret scanner analyzes various types of content in your workspace:"}),"\n",(0,r.jsx)(n.h3,{id:"file-types",children:"File Types"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Source code files (C#, JavaScript, Python, etc.)"}),"\n",(0,r.jsx)(n.li,{children:"Configuration files (appsettings.json, web.config, etc.)"}),"\n",(0,r.jsx)(n.li,{children:"Environment files (.env, .env.local)"}),"\n",(0,r.jsx)(n.li,{children:"Documentation files (README.md, docs)"}),"\n",(0,r.jsx)(n.li,{children:"Script files (PowerShell, Bash, Batch)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"secret-types-detected",children:"Secret Types Detected"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"API Keys"}),": AWS, Azure, Google Cloud, GitHub tokens"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Database Credentials"}),": Connection strings, passwords"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication Tokens"}),": JWT tokens, OAuth secrets"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encryption Keys"}),": Private keys, certificates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Third-party Services"}),": Slack tokens, Discord webhooks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Custom Patterns"}),": User-defined secret patterns"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"how-secret-scanning-works",children:"How Secret Scanning Works"}),"\n",(0,r.jsx)(n.h3,{id:"detection-process",children:"Detection Process"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File Discovery"}),": The scanner recursively searches your workspace for supported file types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Content Analysis"}),": Each file is analyzed using advanced pattern matching and entropy analysis"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"TruffleHog Integration"}),": Leverages TruffleHog's detection rules and algorithms"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Verification"}),": Attempts to verify found secrets when possible"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reporting"}),": Generates a comprehensive report with findings"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"trufflehog-integration",children:"TruffleHog Integration"}),"\n",(0,r.jsxs)(n.p,{children:["The extension integrates with ",(0,r.jsx)(n.a,{href:"https://github.com/trufflesecurity/trufflehog",children:"TruffleHog"}),", a powerful open-source secret scanner:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"High Accuracy"}),": Uses machine learning and entropy analysis to reduce false positives"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Extensive Database"}),": Detects over 700+ secret types from various services"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Active Verification"}),": Attempts to verify secrets with their respective services"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regular Updates"}),": Pattern database is continuously updated with new secret types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Git History Scanning"}),": Can scan through commit history (when configured)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scanning-modes",children:"Scanning Modes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Filesystem Scan"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Scans current workspace files"}),"\n",(0,r.jsx)(n.li,{children:"Fast and lightweight"}),"\n",(0,r.jsx)(n.li,{children:"Ideal for quick security checks"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Git History Scan"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Scans through commit history"}),"\n",(0,r.jsx)(n.li,{children:"Detects secrets in previous commits"}),"\n",(0,r.jsx)(n.li,{children:"Comprehensive but slower"}),"\n",(0,r.jsx)(n.li,{children:"Useful for thorough audits"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"using-secret-scanning",children:"Using Secret Scanning"}),"\n",(0,r.jsx)(n.h3,{id:"starting-a-scan",children:"Starting a Scan"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Open Solution Explorer"}),"\n",(0,r.jsx)(n.li,{children:"Navigate to Tools section"}),"\n",(0,r.jsx)(n.li,{children:'Click on "Secret Scanning"'}),"\n",(0,r.jsx)(n.li,{children:"Choose scan type (Filesystem or Git History)"}),"\n",(0,r.jsx)(n.li,{children:"Wait for scan completion"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scan-results",children:"Scan Results"}),"\n",(0,r.jsx)(n.p,{children:"The scan results provide detailed information:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Active Secrets"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Number of verified active secrets"}),"\n",(0,r.jsx)(n.li,{children:"High-priority items requiring immediate attention"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"All Findings"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Total number of potential secrets detected"}),"\n",(0,r.jsx)(n.li,{children:"Includes both verified and unverified findings"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File Coverage"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Number of files scanned"}),"\n",(0,r.jsx)(n.li,{children:"Scan duration and performance metrics"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Ignored Secrets"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Previously reviewed and ignored findings"}),"\n",(0,r.jsx)(n.li,{children:"Helps track acknowledged false positives"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"managing-findings",children:"Managing Findings"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Review Process"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Examine each finding carefully"}),"\n",(0,r.jsx)(n.li,{children:"Verify if it's a real secret or false positive"}),"\n",(0,r.jsx)(n.li,{children:"Take appropriate action (rotate, remove, or ignore)"}),"\n",(0,r.jsx)(n.li,{children:"Mark findings as reviewed"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Actions Available"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"View Details"}),": See file location and context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Open File"}),": Navigate directly to the finding"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ignore"}),": Mark as false positive"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Copy"}),": Copy finding details for documentation"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"immediate-actions",children:"Immediate Actions"}),"\n",(0,r.jsx)(n.p,{children:"When secrets are found:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rotate Compromised Secrets"}),": Change API keys, passwords immediately"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Remove from Code"}),": Delete secrets from source code"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Secure Storage"}),": Implement proper secret management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review Git History"}),": Check if secrets exist in previous commits"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"prevention-strategies",children:"Prevention Strategies"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Environment Variables"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Instead of hardcoded secrets\nvar apiKey = "sk-1234567890abcdef"; // \u274c Don\'t do this\n\n// Use environment variables\nvar apiKey = Environment.GetEnvironmentVariable("API_KEY"); // \u2705 Better\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration Files"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'// appsettings.json - Use user secrets in development\n{\n  "ConnectionStrings": {\n    "DefaultConnection": "Data Source=localhost;..."\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"User Secrets"})," (Development)"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'dotnet user-secrets set "ConnectionStrings:DefaultConnection" "your-connection-string"\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Azure Key Vault"})," (Production)"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Use Azure Key Vault for production secrets\nvar client = new SecretClient(new Uri(keyVaultUrl), new DefaultAzureCredential());\nvar secret = await client.GetSecretAsync("database-connection");\n'})}),"\n",(0,r.jsx)(n.h3,{id:"secure-development-workflow",children:"Secure Development Workflow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pre-commit Scanning"}),": Run scans before committing code"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CI/CD Integration"}),": Include secret scanning in build pipelines"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regular Audits"}),": Schedule periodic comprehensive scans"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Team Training"}),": Educate team on secure coding practices"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Secret Management"}),": Implement proper secret storage solutions"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/trufflesecurity/trufflehog",children:"TruffleHog GitHub Repository"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://trufflesecurity.com/trufflehog",children:"TruffleHog Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",children:"OWASP Secret Management Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/key-vault/",children:"Azure Key Vault Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/secretsmanager/",children:"AWS Secrets Manager"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The secret scanning tool is an essential component of a secure development workflow. Regular use helps maintain the security posture of your applications and prevents accidental exposure of sensitive information."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);